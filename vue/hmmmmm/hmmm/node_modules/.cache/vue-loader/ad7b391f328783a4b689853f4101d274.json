{"remainingRequest":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\activity\\vue\\hmmmmm\\hmmm\\src\\view\\login\\register.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\src\\view\\login\\register.vue","mtime":1593747421908},{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\activity\\vue\\hmmmmm\\hmmm\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZWwtZGlhbG9nX19oZWFkZXIgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTA5ZGZhOw0KICBsaW5lLWhlaWdodDogMzVweDsNCiAgY29sb3I6ICNmZmY7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgZm9udC1zaXplOiAyMHB4Ow0KfQ0KLmVsLWRpYWxvZ19fZm9vdGVyIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KLmF2YXRhci11cGxvYWRlciB7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7DQogIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5Ow0KICBib3JkZXItcmFkaXVzOiA2cHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQ6aG92ZXIgew0KICBib3JkZXItY29sb3I6ICM0MDllZmY7DQp9DQoNCi5hdmF0YXItdXBsb2FkZXItaWNvbiB7DQogIGZvbnQtc2l6ZTogMjhweDsNCiAgY29sb3I6ICM4YzkzOWQ7DQogIHdpZHRoOiAxNzhweDsNCiAgaGVpZ2h0OiAxNzhweDsNCiAgbGluZS1oZWlnaHQ6IDE3OHB4Ow0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5hdmF0YXIgew0KICB3aWR0aDogMTc4cHg7DQogIGhlaWdodDogMTc4cHg7DQogIGRpc3BsYXk6IGJsb2NrOw0KfQ0K"},{"version":3,"sources":["register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"register.vue","sourceRoot":"src/view/login","sourcesContent":["<template>\r\n  <el-dialog\r\n    title=\"用户注册\"\r\n    :visible.sync=\"dialogVisible\"\r\n    width=\"600px\"\r\n    :show-close=\"false\"\r\n    :close-on-click-modal=\"false\"\r\n    :close-on-press-escape=\"false\"\r\n  >\r\n    <div slot=\"title\" class=\"title\">用户注册</div>\r\n    <el-form label-width=\"80px\" :model=\"form\" :rules=\"rules\" ref=\"form\">\r\n      <el-form-item label=\"头像\" prop=\"avatar\">\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          :action=\"baseURL+'/uploads'\"\r\n          name=\"image\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n        >\r\n          <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"昵称\" prop=\"username\">\r\n        <el-input v-model=\"form.username\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"邮箱\" prop=\"email\">\r\n        <el-input v-model=\"form.email\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"手机\" prop=\"phone\">\r\n        <el-input v-model=\"form.phone\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"密码\" prop=\"password\">\r\n        <el-input v-model=\"form.password\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"图形码\">\r\n        <el-row>\r\n          <el-col :span=\"17\">\r\n            <el-input v-model=\"form.code\"></el-input>\r\n          </el-col>\r\n          <el-col :span=\"6\" :offset=\"1\">\r\n            <img\r\n              :src=\"codeUrl\"\r\n              style=\"width: 100%;height: 40px;\"\r\n              alt\r\n              class=\"imgKey\"\r\n              @click=\"changeImg\"\r\n            />\r\n          </el-col>\r\n        </el-row>\r\n      </el-form-item>\r\n      <el-form-item label=\"验证码\">\r\n        <el-row>\r\n          <el-col :span=\"17\">\r\n            <el-input v-model=\"form.rcode\"></el-input>\r\n          </el-col>\r\n          <el-col :span=\"6\" :offset=\"1\">\r\n            <el-button @click=\"getCode\" :disabled=\"totalTime!=60\">\r\n              获取验证码\r\n              <span v-if=\"totalTime!=60\">{{totalTime}}</span>\r\n            </el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form-item>\r\n    </el-form>\r\n    <span slot=\"footer\" class=\"dialog-footer\">\r\n      <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n      <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\r\n    </span>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { getPhoneCode, register } from \"@/api/register\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      baseURL: process.env.VUE_APP_URL,\r\n      imageUrl: \"\",\r\n      codeUrl: process.env.VUE_APP_URL + \"/captcha?type=sendsms\",\r\n      totalTime: 60,\r\n      form: {\r\n        avatar: \"\",\r\n        username: \"\",\r\n        email: \"\",\r\n        phone: \"\",\r\n        password: \"\",\r\n        code: \"\",\r\n        rcode: \"\"\r\n      },\r\n      // 验证规则\r\n      rules: {\r\n        username: [\r\n          { required: true, message: \"请输入昵称\", trigger: \"change\" }\r\n        ],\r\n        phone: [\r\n          { required: true, message: \"请输入手机号\", trigger: \"change\" },\r\n          //  自定义规则验证\r\n          {\r\n            validator: (rule, value, callback) => {\r\n              let _deg = /^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/;\r\n              if (_deg.test(value)) {\r\n                callback();\r\n              } else {\r\n                callback(\"请输入正确的手机号\");\r\n              }\r\n            },\r\n            trigger: \"change\"\r\n          }\r\n        ],\r\n        email: [\r\n          { required: true, message: \"请输入邮箱\", trigger: \"change\" },\r\n          {\r\n            validator: (rule, value, callback) => {\r\n              let _deg = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\r\n              if (_deg.test(value)) {\r\n                callback();\r\n              } else {\r\n                callback(\"请输入正确的邮箱格式\");\r\n              }\r\n            },\r\n            trigger: \"change\"\r\n          }\r\n        ],\r\n        password: [\r\n          { required: true, message: \"请输入密码\", trigger: \"change\" },\r\n          {\r\n            validator: (rule, value, callback) => {\r\n              let _deg = /^\\w+$/;\r\n              if (_deg.test(value)) {\r\n                callback();\r\n              } else {\r\n                callback(\"密码只能由英文,数字,下划线组成\");\r\n              }\r\n            },\r\n            trigger: \"change\"\r\n          },\r\n          { min: 6, max: 12, message: \"请输入6-12位密码\", trigger: \"change\" }\r\n        ],\r\n        avatar: [{ required: true, message: \"请上传头像\", trigger: \"change\" }],\r\n        code: [{ required: true, message: \"请输入图形码\", trigger: \"change\" }],\r\n        rcode: [{ required: true, message: \"请输入验证码\", trigger: \"change\" }]\r\n      }\r\n    };\r\n  },\r\n    watch: {\r\n      dialogVisible(newVal) {\r\n        if (newVal == false) {\r\n          this.$refs.form.resetFields();\r\n          this.imageUrl = \"\";\r\n        }\r\n      }\r\n    },\r\n  methods: {\r\n    handleAvatarSuccess(res) {\r\n      this.imageUrl = this.baseURL + \"/\" + res.data.file_path;\r\n      this.form.avatar = res.data.file_path;\r\n      //  根据头像是否上传来判断是否显示提示\r\n      this.$refs.form.validateField(\"avatar\");\r\n      // console.log(res);\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isJPG =\r\n        file.type === \"image/jpeg\" ||\r\n        file.type === \"image/png\" ||\r\n        file.type === \"image/gif\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n      if (!isJPG) {\r\n        this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    changeImg() {\r\n      this.codeUrl =\r\n        process.env.VUE_APP_URL + \"/captcha?type=login&t=\" + Date.now();\r\n    },\r\n    submit() {\r\n      this.$refs.form.validate(valid => {\r\n        // window.console.log(valid);\r\n        if (valid) {\r\n          //  调用发送请求方法\r\n          register(this.form).then(() => {\r\n            // window.console.log(res);\r\n            this.$message.success(\"注册成功!\");\r\n            this.dialogVisible = false;\r\n          });\r\n        }\r\n      });\r\n    },\r\n    getCode() {\r\n      let _pass = true;\r\n      this.$refs.form.validateField([\"code\", \"phone\"], error => {\r\n        if (error != \"\") {\r\n          _pass = false;\r\n        }\r\n      });\r\n      if (_pass == false) {\r\n        return;\r\n      } else {\r\n        // 获取验证码倒计时\r\n        this.totalTime--;\r\n        let timeID = setInterval(() => {\r\n          this.totalTime--;\r\n          if (this.totalTime <= 0) {\r\n            clearInterval(timeID);\r\n            this.totalTime = 60;\r\n          }\r\n        }, 1000);\r\n        // 调用发送请求方法\r\n        getPhoneCode({\r\n          code: this.form.code,\r\n          phone: this.form.phone\r\n        }).then(res => {\r\n          //成功回调\r\n          // window.console.log(res)\r\n          this.$message.success(res.data.captcha + \"\");\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.el-dialog__header {\r\n  background-color: #109dfa;\r\n  line-height: 35px;\r\n  color: #fff;\r\n  text-align: center;\r\n  font-size: 20px;\r\n}\r\n.el-dialog__footer {\r\n  text-align: center;\r\n}\r\n.avatar-uploader {\r\n  text-align: center;\r\n}\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>"]}]}